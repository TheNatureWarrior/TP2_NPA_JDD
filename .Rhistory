df=subset(df,select = -c(id,ethnicity,ethnicity_other,received_covid_vaccine,
covid_vaccine,pao2,pao2_fio2,ph,
high_senstivity_cardiac_troponin,esr,ferritin,
hs_crp,aptt_aptr,medications,comorbidities_other))
#Now to rename.
newNames<-c('reason', 'age', 'sex', 'height', 'weight',
'comorb',
'smoke_hist', 'year_quit', 'er_2_weeks',
'adm_disp', 'systolic_bp',
'diastolic_bp', 'heart_rate', 'respiratory_rate',
'oxygen_sat', 'temp', 'motor', 'verbal', 'eye',
'intubated', 'wbc', 'rbc', 'hemoglobin', 'hematocrit', 'mcv', 'mch',
'mchc', 'rdw', 'platelet_count', 'pt', 'alt', 'ast', 'serum_creatinine',
'sodium', 'potassium', 'total_serum_bilirubin', 'lactate', 'inr',
'd_dimer', 'crp')
colnames(df)<-newNames
#Note that many values are "", which aren't counted as NA.
df %>% group_by(smoke_hist) %>%
count()
setwd("C:/Users/natal/Desktop/Bellarmine/Spring 2022/DS/Team Project 2")
library(tidyverse)
library(lubridate)
#On top bar, go to Session:
#Set Working Directory:
#To Source File Location
df<-read.csv('Canada_Hosp1_COVID_Data_At_Admission.csv',sep=",")
#Going to drop all columns we dropped eventually in
#original project
df=subset(df,select = -c(id,ethnicity,ethnicity_other,received_covid_vaccine,
covid_vaccine,pao2,pao2_fio2,ph,
high_senstivity_cardiac_troponin,esr,ferritin,
hs_crp,aptt_aptr,medications,comorbidities_other))
#Now to rename.
newNames<-c('reason', 'age', 'sex', 'height', 'weight',
'comorb',
'smoke_hist', 'year_quit', 'er_2_weeks',
'adm_disp', 'systolic_bp',
'diastolic_bp', 'heart_rate', 'respiratory_rate',
'oxygen_sat', 'temp', 'motor', 'verbal', 'eye',
'intubated', 'wbc', 'rbc', 'hemoglobin', 'hematocrit', 'mcv', 'mch',
'mchc', 'rdw', 'platelet_count', 'pt', 'alt', 'ast', 'serum_creatinine',
'sodium', 'potassium', 'total_serum_bilirubin', 'lactate', 'inr',
'd_dimer', 'crp')
colnames(df)<-newNames
#Note that many values are "", which aren't counted as NA.
df %>% group_by(smoke_hist) %>%
count()
#Fixing using mutate and na_if.
#Goes through all columns in df, checks if its a character
#column, and if it is, maps it through na_if, which replaces
#each "" value with NA.
df<-df %>%
mutate(across(where(is.character),~na_if(.,"")))
#To also clean out nulls in comorb
df<-df %>%
mutate(across(where(is.character),~na_if(.,"[]")))
df %>% group_by(comorb) %>%
count()
#Now to fix up comorb some
#Testing some functions I may use to make clean function
grepl("helpmeout","why dont you help me out", fixed=TRUE)
grepl("hel","why odnt you help me out", fixed=TRUE)
grepl("apple", "happliness")
grepl("apple", "happliness",fixed=TRUE)
grepl("hel","why odnt you help me out", fixed=FALSE)
#Now to fix up comorb some
#Testing some functions I may use to make clean function
grepl("helpmeout","why dont you help me out", fixed=FALSE)
#Now to fix up comorb some
#Testing some functions I may use to make clean function
grepl("helpmeout","why dont you help me out", fixed=TRUE)
grepl("hel","why odnt you help me out", fixed=TRUE)
grepl("apple", "happlessness",fixed=TRUE)
ifelse(grepl("",x,fixed=TRUE),"",
ifelse(grepl("[J80]",x,fixed=TRUE),"ARDS",
ifelse(grepl("[J18.9]",x,fixed=TRUE),"Pneumonia",
ifelse(grepl("[U07.1]",x,fixed=TRUE),"COVID-19",
ifelse(grepl("[U07.2]",x,fixed=TRUE),"Probable COVID-19",
ifelse(grepl("[B34.2]",x,fixed=TRUE),"Coronavirus infection",
ifelse(grepl("[R05]",x,fixed=TRUE),"Cough",
ifelse(grepl("[J98.9,R50.9]",x,fixed=TRUE),"Febrile respiratory illness",
ifelse(grepl("[R50.9]",x,fixed=TRUE),"Fever",
ifelse(grepl("[R09.0]",x,fixed=TRUE),"Hypoxemia",
ifelse(grepl("[M79.19]",x,fixed=TRUE),"Myalgia",
ifelse(grepl("[U07.1,J12.8]",x,fixed=TRUE),"Pneumonia due to COVID-19",
ifelse(grepl("[R06.0]",x,fixed=TRUE),"Shortness of breath",
ifelse(grepl("[R06.0,U07.2]",x,fixed=TRUE),"Shortness of breath with exposure to COVID-19",
ifelse(grepl("[R06.8]",x,fixed=TRUE),"Tachypnea",
ifelse(grepl("[J12.9]",x,fixed=TRUE),"Viral pneumonia",
ifelse(grepl("[J96.99]",x,fixed=TRUE),"Respiratory failure",
ifelse(grepl("[J98.8]",x,fixed=TRUE),"Respiratory tract infection", x)
))))))))))))))))
ifelse(grepl("[J80]",x,fixed=TRUE),"ARDS",
ifelse(grepl("[J18.9]",x,fixed=TRUE),"Pneumonia",
ifelse(grepl("[U07.1]",x,fixed=TRUE),"COVID-19",
ifelse(grepl("[U07.2]",x,fixed=TRUE),"Probable COVID-19",
ifelse(grepl("[B34.2]",x,fixed=TRUE),"Coronavirus infection",
ifelse(grepl("[R05]",x,fixed=TRUE),"Cough",
ifelse(grepl("[J98.9,R50.9]",x,fixed=TRUE),"Febrile respiratory illness",
ifelse(grepl("[R50.9]",x,fixed=TRUE),"Fever",
ifelse(grepl("[R09.0]",x,fixed=TRUE),"Hypoxemia",
ifelse(grepl("[M79.19]",x,fixed=TRUE),"Myalgia",
ifelse(grepl("[U07.1,J12.8]",x,fixed=TRUE),"Pneumonia due to COVID-19",
ifelse(grepl("[R06.0]",x,fixed=TRUE),"Shortness of breath",
ifelse(grepl("[R06.0,U07.2]",x,fixed=TRUE),"Shortness of breath with exposure to COVID-19",
ifelse(grepl("[R06.8]",x,fixed=TRUE),"Tachypnea",
ifelse(grepl("[J12.9]",x,fixed=TRUE),"Viral pneumonia",
ifelse(grepl("[J96.99]",x,fixed=TRUE),"Respiratory failure",
ifelse(grepl("[J98.8]",x,fixed=TRUE),"Respiratory tract infection", x)
))))))))))))))))
ifelse(grepl("[J80]",x,fixed=TRUE),"ARDS",
ifelse(grepl("[J18.9]",x,fixed=TRUE),"Pneumonia",
ifelse(grepl("[U07.1]",x,fixed=TRUE),"COVID-19",
ifelse(grepl("[U07.2]",x,fixed=TRUE),"Probable COVID-19",
ifelse(grepl("[B34.2]",x,fixed=TRUE),"Coronavirus infection",
ifelse(grepl("[R05]",x,fixed=TRUE),"Cough",
ifelse(grepl("[J98.9,R50.9]",x,fixed=TRUE),"Febrile respiratory illness",
ifelse(grepl("[R50.9]",x,fixed=TRUE),"Fever",
ifelse(grepl("[R09.0]",x,fixed=TRUE),"Hypoxemia",
ifelse(grepl("[M79.19]",x,fixed=TRUE),"Myalgia",
ifelse(grepl("[U07.1,J12.8]",x,fixed=TRUE),"Pneumonia due to COVID-19",
ifelse(grepl("[R06.0]",x,fixed=TRUE),"Shortness of breath",
ifelse(grepl("[R06.0,U07.2]",x,fixed=TRUE),"Shortness of breath with exposure to COVID-19",
ifelse(grepl("[R06.8]",x,fixed=TRUE),"Tachypnea",
ifelse(grepl("[J12.9]",x,fixed=TRUE),"Viral pneumonia",
ifelse(grepl("[J96.99]",x,fixed=TRUE),"Respiratory failure",
ifelse(grepl("[J98.8]",x,fixed=TRUE),"Respiratory tract infection", x)
)))))))))))))))))
ifelse(grepl("[J80]",x,fixed=TRUE),"ARDS",
ifelse(grepl("[J18.9]",x,fixed=TRUE),"Pneumonia",
ifelse(grepl("[U07.1]",x,fixed=TRUE),"COVID-19",
ifelse(grepl("[U07.2]",x,fixed=TRUE),"Probable COVID-19",
ifelse(grepl("[B34.2]",x,fixed=TRUE),"Coronavirus infection",
ifelse(grepl("[R05]",x,fixed=TRUE),"Cough",
ifelse(grepl("[J98.9,R50.9]",x,fixed=TRUE),"Febrile respiratory illness",
ifelse(grepl("[R50.9]",x,fixed=TRUE),"Fever",
ifelse(grepl("[R09.0]",x,fixed=TRUE),"Hypoxemia",
ifelse(grepl("[M79.19]",x,fixed=TRUE),"Myalgia",
ifelse(grepl("[U07.1,J12.8]",x,fixed=TRUE),"Pneumonia due to COVID-19",
ifelse(grepl("[R06.0]",x,fixed=TRUE),"Shortness of breath",
ifelse(grepl("[R06.0,U07.2]",x,fixed=TRUE),"Shortness of breath with exposure to COVID-19",
ifelse(grepl("[R06.8]",x,fixed=TRUE),"Tachypnea",
ifelse(grepl("[J12.9]",x,fixed=TRUE),"Viral pneumonia",
ifelse(grepl("[J96.99]",x,fixed=TRUE),"Respiratory failure",
ifelse(grepl("[J98.8]",x,fixed=TRUE),"Respiratory tract infection", x)
))))))))))))))))
streamreason<- function(x){
ifelse(grepl("[J80]",x,fixed=TRUE),"ARDS",
ifelse(grepl("[J18.9]",x,fixed=TRUE),"Pneumonia",
ifelse(grepl("[U07.1]",x,fixed=TRUE),"COVID-19",
ifelse(grepl("[U07.2]",x,fixed=TRUE),"Probable COVID-19",
ifelse(grepl("[B34.2]",x,fixed=TRUE),"Coronavirus infection",
ifelse(grepl("[R05]",x,fixed=TRUE),"Cough",
ifelse(grepl("[J98.9,R50.9]",x,fixed=TRUE),"Febrile respiratory illness",
ifelse(grepl("[R50.9]",x,fixed=TRUE),"Fever",
ifelse(grepl("[R09.0]",x,fixed=TRUE),"Hypoxemia",
ifelse(grepl("[M79.19]",x,fixed=TRUE),"Myalgia",
ifelse(grepl("[U07.1,J12.8]",x,fixed=TRUE),"Pneumonia due to COVID-19",
ifelse(grepl("[R06.0]",x,fixed=TRUE),"Shortness of breath",
ifelse(grepl("[R06.0,U07.2]",x,fixed=TRUE),"Shortness of breath with exposure to COVID-19",
ifelse(grepl("[R06.8]",x,fixed=TRUE),"Tachypnea",
ifelse(grepl("[J12.9]",x,fixed=TRUE),"Viral pneumonia",
ifelse(grepl("[J96.99]",x,fixed=TRUE),"Respiratory failure",
ifelse(grepl("[J98.8]",x,fixed=TRUE),"Respiratory tract infection", x)
))))))))))))))))
}
#Testing
dfex<-df
dfex<-dfex %>%
mutate(across(where(is.character),~(streamreason(.))))
dfex %>% group_by(reason) %>%
count()
streamreason<- function(x){
ifelse(grepl("[J80]",x,fixed=TRUE),"ARDS",
ifelse(grepl("[J18.9]",x,fixed=TRUE),"Pneumonia",
ifelse(grepl("[U07.1]",x,fixed=TRUE),"COVID-19",
ifelse(grepl("[U07.2]",x,fixed=TRUE),"Probable COVID-19",
ifelse(grepl("[B34.2]",x,fixed=TRUE),"Coronavirus infection",
ifelse(grepl("[R05]",x,fixed=TRUE),"Cough",
ifelse(grepl("[J98.9, R50.9]",x,fixed=TRUE),"Febrile respiratory illness",
ifelse(grepl("[R50.9]",x,fixed=TRUE),"Fever",
ifelse(grepl("[R09.0]",x,fixed=TRUE),"Hypoxemia",
ifelse(grepl("[M79.19]",x,fixed=TRUE),"Myalgia",
ifelse(grepl("[U07.1, J12.8]",x,fixed=TRUE),"Pneumonia due to COVID-19",
ifelse(grepl("[R06.0]",x,fixed=TRUE),"Shortness of breath",
ifelse(grepl("[R06.0, U07.2]",x,fixed=TRUE),"Shortness of breath with exposure to COVID-19",
ifelse(grepl("[R06.8]",x,fixed=TRUE),"Tachypnea",
ifelse(grepl("[J12.9]",x,fixed=TRUE),"Viral pneumonia",
ifelse(grepl("[J96.99]",x,fixed=TRUE),"Respiratory failure",
ifelse(grepl("[J98.8]",x,fixed=TRUE),"Respiratory tract infection", x)
))))))))))))))))
}
#Testing
dfex<-df
dfex<-dfex %>%
mutate(across(where(is.character),~(streamreason(.))))
dfex %>% group_by(reason) %>%
count()
df<-df %>%
mutate(across(where(is.character),~(streamreason(.))))
df %>% group_by(reason) %>%
count()
#Alright, now reason is fixed.
#Now going to quickly fix motor, verbal, and eye before I fix comorb.
mutate?
dfx<-df
dfx<-df
dfx %>%
select(motor,verrbal,eye) %>%
mutate(across(where(is.integer),~as.character(.))))
dfx %>%
select(motor,verrbal,eye) %>%
mutate(across(where(is.integer),~as.character(.)))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer),~as.character(.)))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer,as.character))))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer,as.character)))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer),~(as.character))))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer),~(as.character)))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer),~(as.character(.))))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer)),~(as.character(.)))))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer)),~(as.character(.))))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer)),~(as.character(.)))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer)),as.character(.))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer)),as.character)
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(.cols=everything()),as.character)
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(.cols=everything()),as.character(.))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(.cols=everything()),~as.character(.))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(.cols=everything()),~(as.character(.))))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(.cols=everything()),~(as.character(.)))
dfx %>%
select(motor,verbal,eye) %>%
mutate(across(where(is.integer),~(as.character(.))))
dfx$motor<-as.character(dfx$motor)
df$motor<-as.character(df$motor)
df$eye<-as.character(df$eye)
df$verbal<-as.character(df%verbal)
df$verbal<-as.character(df%verbal)
df$verbal<-as.character(df$verbal)
df %>% group_by(verbal) %>%
count()
df %>% group_by(smoke_hist) %>%
count()
#Fixed those, now onto comorb.
fixcomorb<-function(x){
ifelse(grepl("Asthma",x,fixed=TRUE),
ifelse(grepl("ypertension",x,fixed=TRUE),  #Asthma true
ifelse(grepl("pulmonary",x,fixed=TRUE), #Asthma true, Hyper tension true
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma true, hypertension true, lung true
"Asthma, Chronic cardiac disease, Chronic pulmonary disease, Diabetes", #Asthma true, hyper true, pul true, diabet true
"Asthma, Chronic cardiac disease, Chronic pulmonary disease"), #Asthma true, card true, pul true, dia false
), ifelse(grepl("Diabetes",x,fixed=TRUE),"Asthma, Chronic cardiac disease, Diabetes", #asthma true, hyper true, pul false
"Asthma, Chronic cardiac disease"),#Asthma true, chronic truue, pul false, diabetes false
ifelse(grepl("pulmonary",x,fixed=TRUE),#asthma true, hypertension false
ifelse(grepl("Diabetes",x,fixed=TRUE),#asthma true, hyper false, pul true
"Asthma, Chronic pulmonary disease, Diabetes",  #asthhma true, hyper f, pul t, di t
"Asthma, Chronic pulmonary disease")  #asthma true, hyper f, pul t, di f
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma t, hyper f, pul f
"Asthma, Diabetes", #asthma t, hyper f, pul f, dia t
"Asthma"))),  #asthma t, else f
ifelse(grepl("ypertension",x,fixed=TRUE), #Asthma f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a f, h t
ifelse(grep1("Diabetes",x,fixed=TRUE),         #a f, h t, p t,
"Chronic cardiac disease, Chronic pulmonary disease, Diabetes",#a f h t p t dt
"Chronic cardiac disease, chronic pulmonary disease"), # a f h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),   #a f h t p f
"Chronic cardiac disease, Diabetes",  #a f h t p f d t
"Chronic cardiac disease")), #a f h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),#a f h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a f h f p t
"Chronic pulmonary disease, Diabetes",#a f h f p t d t
"Chronic pulmonary disease"), #a f h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),# a f h f p f
"Diabetes",# a f h f p f d t
NA)# a f h f p f d f
)))
}
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma t, hyper f, pul f
"Asthma, Diabetes", #asthma t, hyper f, pul f, dia t
"Asthma"))),  #asthma t, else f
ifelse(grepl("ypertension",x,fixed=TRUE), #Asthma f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a f, h t
ifelse(grep1("Diabetes",x,fixed=TRUE),         #a f, h t, p t,
"Chronic cardiac disease, Chronic pulmonary disease, Diabetes",#a f h t p t dt
"Chronic cardiac disease, chronic pulmonary disease"), # a f h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),   #a f h t p f
"Chronic cardiac disease, Diabetes",  #a f h t p f d t
"Chronic cardiac disease")), #a f h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),#a f h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a f h f p t
"Chronic pulmonary disease, Diabetes",#a f h f p t d t
"Chronic pulmonary disease"), #a f h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),# a f h f p f
"Diabetes",# a f h f p f d t
NA) # a f h f p f d f
}
#Fixed those, now onto comorb.
fixcomorb<-function(x){
ifelse(grepl("Asthma",x,fixed=TRUE),
ifelse(grepl("ypertension",x,fixed=TRUE),  #Asthma true
ifelse(grepl("pulmonary",x,fixed=TRUE), #Asthma true, Hyper tension true
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma true, hypertension true, lung true
"Asthma, Chronic cardiac disease, Chronic pulmonary disease, Diabetes", #Asthma true, hyper true, pul true, diabet true
"Asthma, Chronic cardiac disease, Chronic pulmonary disease"), #Asthma true, card true, pul true, dia false
), ifelse(grepl("Diabetes",x,fixed=TRUE),"Asthma, Chronic cardiac disease, Diabetes", #asthma true, hyper true, pul false
"Asthma, Chronic cardiac disease"),#Asthma true, chronic truue, pul false, diabetes false
ifelse(grepl("pulmonary",x,fixed=TRUE),#asthma true, hypertension false
ifelse(grepl("Diabetes",x,fixed=TRUE),#asthma true, hyper false, pul true
"Asthma, Chronic pulmonary disease, Diabetes",  #asthhma true, hyper f, pul t, di t
"Asthma, Chronic pulmonary disease"),  #asthma true, hyper f, pul t, di f
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma t, hyper f, pul f
"Asthma, Diabetes", #asthma t, hyper f, pul f, dia t
"Asthma"))),  #asthma t, else f
ifelse(grepl("ypertension",x,fixed=TRUE), #Asthma f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a f, h t
ifelse(grep1("Diabetes",x,fixed=TRUE),         #a f, h t, p t,
"Chronic cardiac disease, Chronic pulmonary disease, Diabetes",#a f h t p t dt
"Chronic cardiac disease, chronic pulmonary disease"), # a f h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),   #a f h t p f
"Chronic cardiac disease, Diabetes",  #a f h t p f d t
"Chronic cardiac disease")), #a f h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),#a f h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a f h f p t
"Chronic pulmonary disease, Diabetes",#a f h f p t d t
"Chronic pulmonary disease"), #a f h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),# a f h f p f
"Diabetes",# a f h f p f d t
NA) # a f h f p f d f
)))
}
debugSource("C:/Users/natal/Desktop/Bellarmine/Spring 2022/DS/Team Project 2/TP2_NPA_JDD.R", echo=TRUE)
#Fixed those, now onto comorb.
fixcomorb<-function(x){
ifelse(grepl("Asthma",x,fixed=TRUE),
ifelse(grepl("ypertension",x,fixed=TRUE),  #Asthma true
ifelse(grepl("pulmonary",x,fixed=TRUE), #Asthma true, Hyper tension true
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma true, hypertension true, lung true
"Asthma, Chronic cardiac disease, Chronic pulmonary disease, Diabetes", #Asthma true, hyper true, pul true, diabet true
"Asthma, Chronic cardiac disease, Chronic pulmonary disease"), #Asthma true, card true, pul true, dia false
), ifelse(grepl("Diabetes",x,fixed=TRUE),"Asthma, Chronic cardiac disease, Diabetes", #asthma true, hyper true, pul false
"Asthma, Chronic cardiac disease"),#Asthma true, chronic truue, pul false, diabetes false
ifelse(grepl("pulmonary",x,fixed=TRUE),#asthma true, hypertension false
ifelse(grepl("Diabetes",x,fixed=TRUE),#asthma true, hyper false, pul true
"Asthma, Chronic pulmonary disease, Diabetes",  #asthhma true, hyper f, pul t, di t
"Asthma, Chronic pulmonary disease"),  #asthma true, hyper f, pul t, di f
ifelse(grepl("Diabetes",x,fixed=TRUE), #Asthma t, hyper f, pul f
"Asthma, Diabetes", #asthma t, hyper f, pul f, dia t
"Asthma"))),  #asthma t, else f
ifelse(grepl("ypertension",x,fixed=TRUE), #Asthma f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a f, h t
ifelse(grep1("Diabetes",x,fixed=TRUE),         #a f, h t, p t,
"Chronic cardiac disease, Chronic pulmonary disease, Diabetes",#a f h t p t dt
"Chronic cardiac disease, chronic pulmonary disease"), # a f h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),   #a f h t p f
"Chronic cardiac disease, Diabetes",  #a f h t p f d t
"Chronic cardiac disease")), #a f h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),#a f h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a f h f p t
"Chronic pulmonary disease, Diabetes",#a f h f p t d t
"Chronic pulmonary disease"), #a f h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),# a f h f p f
"Diabetes",# a f h f p f d t
NA) # a f h f p f d f
)))
}
dfex<-df
fixcomb(sample(dfex$comorb,10))
fixcomorb(sample(dfex$comorb,10))
fixcomorb("Asthma")
#Fixed those, now onto comorb.
fixcomorb<-function(x){
ifelse(grepl("Asthma",x,fixed=TRUE),
ifelse(grepl("ypertension",x,fixed=TRUE),  #a t
ifelse(grepl("pulmonary",x,fixed=TRUE), #a t h t
ifelse(grepl("Diabetes",x,fixed=TRUE), #a t h t p t
"Asthma, Chronic cardiac disease, Chronic pulmonary disease, Diabetes", #all t
"Asthma, Chronic cardiac disease, Chronic pulmonary disease"), #a t h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE), #a t h t p f
"Asthma, Chronic cardiac disease, Diabetes", #a t h t p f d t
"Asthma, Chronic cardiac disease")),#a t h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a t h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a t h f p t
"Asthma, Chronic pulmonary disease, Diabetes",  #a t h f p t d t
"Asthma, Chronic pulmonary disease"),  #a t h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE), #a t h f p f
"Asthma, Diabetes", #a t h f p f d t
"Asthma"))),  #a t h f p f d f
ifelse(grepl("ypertension",x,fixed=TRUE), #a f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a f h t
ifelse(grep1("Diabetes",x,fixed=TRUE), # a f h t p t
"Chronic cardiac disease, Chronic pulmonary disease, Diabetes",#a f h t p t d t
"Chronic cardiac disease, chronic pulmonary disease"), # a f h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),   #a f h t p f
"Chronic cardiac disease, Diabetes",  #a f h t p f d t
"Chronic cardiac disease")), #a f h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),#a f h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a f h f p t
"Chronic pulmonary disease, Diabetes",#a f h f p t d t
"Chronic pulmonary disease"), #a f h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),# a f h f p f
"Diabetes",# a f h f p f d t
NA)))) # a f h f p f d f
}
fixcomorb(sample(dfex$comorb,10))
fixcomorb("Asthma")
fixcomorb("Asthma, hello, how are you, whatever, Hypertension")
fixcomorb("Diabetes, whatever whatever, asthma, hello")
fixcomorb("Diabetes, whatever whatever, Asthma, hello")
a<-sample(dfex$comorb,5)
a
fixcomorb(a)
#Fixed those, now onto comorb.
fixcomorb<-function(x){
ifelse(grepl("Asthma",x,fixed=TRUE),
ifelse(grepl("ypertension",x,fixed=TRUE),  #a t
ifelse(grepl("pulmonary",x,fixed=TRUE), #a t h t
ifelse(grepl("Diabetes",x,fixed=TRUE), #a t h t p t
"Asthma, Chronic cardiac disease, Chronic pulmonary disease, Diabetes", #all t
"Asthma, Chronic cardiac disease, Chronic pulmonary disease"), #a t h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE), #a t h t p f
"Asthma, Chronic cardiac disease, Diabetes", #a t h t p f d t
"Asthma, Chronic cardiac disease")),#a t h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a t h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a t h f p t
"Asthma, Chronic pulmonary disease, Diabetes",  #a t h f p t d t
"Asthma, Chronic pulmonary disease"),  #a t h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE), #a t h f p f
"Asthma, Diabetes", #a t h f p f d t
"Asthma"))),  #a t h f p f d f
ifelse(grepl("ypertension",x,fixed=TRUE), #a f
ifelse(grepl("pulmonary",x,fixed=TRUE),# a f h t
ifelse(grepl("Diabetes",x,fixed=TRUE), # a f h t p t
"Chronic cardiac disease, Chronic pulmonary disease, Diabetes",#a f h t p t d t
"Chronic cardiac disease, chronic pulmonary disease"), # a f h t p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),   #a f h t p f
"Chronic cardiac disease, Diabetes",  #a f h t p f d t
"Chronic cardiac disease")), #a f h t p f d f
ifelse(grepl("pulmonary",x,fixed=TRUE),#a f h f
ifelse(grepl("Diabetes",x,fixed=TRUE),#a f h f p t
"Chronic pulmonary disease, Diabetes",#a f h f p t d t
"Chronic pulmonary disease"), #a f h f p t d f
ifelse(grepl("Diabetes",x,fixed=TRUE),# a f h f p f
"Diabetes",# a f h f p f d t
NA)))) # a f h f p f d f
}
#Testing
dfex<-df
fixcomorb(sample(dfex$comorb,10))
fixcomorb("Asthma")
fixcomorb("Asthma, hello, how are you, whatever, Hypertension")
fixcomorb("Diabetes, whatever whatever, Asthma, hello")
a<-sample(dfex$comorb,5)
a
fixcomorb(a)
a<-sample(dfex$comorb,5)
a
fixcomorb(a)
a<-sample(dfex$comorb,25)
a
fixcomorb(a)
a<-sample(dfex$comorb,25)
a
fixcomorb(a)
#Testing
a<-sample(df$comorb,25)
a
fixcomorb(a)
#Testing
dfex<-df
a<-sample(df$comorb,25)
a
fixcomorb(a)
b<-dfex$comorb
fixcomorb(b)
dfex$comorb<-fixcomorb(dfex$comorb)
dfex %>% group_by(comorb) %>%
count()
#Seems to work!
df$comorb<-fixcomorb(df$comorb)
df %>% group_by(comorb) %>%
count()
